/*!
 * =====================================================
 * huixing v1.0.0 (17-09-15)
 * author:tanghao
 * =====================================================
 */
function pickerDateRange(a,b){function c(a){var b=document,c=b.createElement("link");c.setAttribute("rel","stylesheet"),c.setAttribute("type","text/css"),c.setAttribute("href",a);var d=b.getElementsByTagName("head");d.length?d[0].appendChild(c):b.documentElement.appendChild(c)}function d(){l.mOpts.isSingleDay&&""!=l.mOpts.realstartVal&&($("#"+l.dateInput).val(l.mOpts.realstartVal),$("#"+l.endDateId).val(l.mOpts.realstartVal))}function e(){$(".dateRangeDateTable td").hasClass("first")&&$(".first").parents("table").offset().top>400&&$("body").animate({scrollTop:$(".first").parents("table").offset().top-50},100),$(".dateRangeDateTable td").hasClass("today")&&$(".today").parents("table").offset().top>400&&$("body").animate({scrollTop:$(".today").parents("table").offset().top-50},100)}var f=(new Date).getTime()-864e5,g=(new Date).getTime()+10368e7,h=Math.round(f/1e3),i=Math.round(g/1e3),j='<section id="appendParent" style="display: block; z-index:9998; position: absolute; top:0; left:0; width:100%;"></section>';$("#appendParent").length<=0&&$("body").append(j);var k={aToday:"aToday",aYesterday:"aYesterday",aRecent7Days:"aRecent7Days",aRecent14Days:"aRecent14Days",aRecent30Days:"aRecent30Days",aRecent90Days:"aRecent90Days",startDate:"",endDate:"",startCompareDate:"",endCompareDate:"",minValidDate:h,maxValidDate:i,success:function(a){return!0},startDateId:"startDate",startCompareDateId:"startCompareDate",endDateId:"endDate",endCompareDateId:"endCompareDate",target:"",needCompare:!1,suffix:"",inputTrigger:"input_trigger",compareTrigger:"compare_trigger",compareCheckboxId:"needCompare",calendars:12,dayRangeMax:0,monthRangeMax:12,dateTable:"dateRangeDateTable",selectCss:"dateRangeSelected",compareCss:"dateRangeCompare",coincideCss:"dateRangeCoincide",firstCss:"first",lastCss:"last",clickCss:"today",disableGray:"dateRangeGray",isToday:"dateRangeToday",joinLineId:"joinLine",isSingleDay:!1,defaultText:" 至 ",rangeFromText:"入住",rangeToText:"离店",singleCompare:!1,stopToday:!1,isTodayValid:!1,weekendDis:!1,disCertainDay:[],disCertainDate:[],shortOpr:!1,noCalendar:!1,theme:"gri",magicSelect:!1,autoCommit:!1,autoSubmit:!0,replaceBtn:"btn_compare",realstartVal:"",isMonthBeyond:!1,cssUrl:"../",initBefore:function(){return!0},selectRanged:!1,selectRangedStart:"",selectRangedEnd:"",isSelectBtn:!1},l=this;this.inputId=a,this.inputCompareId=a+"Compare",this.compareInputDiv="div_compare_"+a,this.mOpts=$.extend({},k,b);var m=this.mOpts.cssUrl+"assets/plugins/calenderPicker/calendarRangePicker-blue.css";c(m),$('<style>.ta_calendar td.first.zhu:after, .ta_calendar td.today.zhu:after, .ta_calendar td.last.li:after {content: "'+this.mOpts.rangeFromText+'"}.ta_calendar td.last.li:after {content: "'+this.mOpts.rangeToText+'"}</style>').appendTo("head"),this.mOpts.isSingleDay||(this.mOpts.firstCss="zhu first",this.mOpts.clickCss="zhu today",this.mOpts.lastCss="li last"),this.mOpts.selectRangedStart=this.IsDate("selectRangedStart",this.mOpts.selectRangedStart)?l.str2date(this.mOpts.selectRangedStart).getTime():0,this.mOpts.selectRangedEnd=this.IsDate("selectRangedEnd",this.mOpts.selectRangedEnd)?l.str2date(this.mOpts.selectRangedEnd).getTime():1e16,this.mOpts.calendars=Math.min(this.mOpts.calendars,12),this.mOpts.compareCss="ta"==this.mOpts.theme?this.mOpts.selectCss:this.mOpts.compareCss,this.periodObj={},this.periodObj[l.mOpts.aToday]=0,this.periodObj[l.mOpts.aYesterday]=1,this.periodObj[l.mOpts.aRecent7Days]=6,this.periodObj[l.mOpts.aRecent14Days]=13,this.periodObj[l.mOpts.aRecent30Days]=29,this.periodObj[l.mOpts.aRecent90Days]=89,this.startDefDate="";var n=""==this.mOpts.suffix?(new Date).getTime():this.mOpts.suffix;this.calendarId="calendar_"+n,this.dateListId="dateRangePicker_"+n,this.dateRangeCompareDiv="dateRangeCompareDiv_"+n,this.dateRangeDiv="dateRangeDiv_"+n,this.compareCheckBoxDiv="dateRangeCompareCheckBoxDiv_"+n,this.submitBtn="submit_"+n,this.closeBtn="closeBtn_"+n,this.preMonth="dateRangePreMonth_"+n,this.nextMonth="dateRangeNextMonth_"+n,this.startDateId=this.mOpts.startDateId+"_"+n,this.endDateId=this.mOpts.endDateId+"_"+n,this.compareCheckboxId=this.mOpts.compareCheckboxId+"_"+n,this.startCompareDateId=this.mOpts.startCompareDateId+"_"+n,this.endCompareDateId=this.mOpts.endCompareDateId+"_"+n;var o={gri:['<div id="'+this.calendarId+'" class="gri_dateRangeCalendar">','<table class="gri_dateRangePicker"><tr id="'+this.dateListId+'"></tr></table>','<div class="gri_dateRangeOptions" '+(this.mOpts.autoSubmit?' style="display:none" ':"")+">",'<div class="gri_dateRangeInput" id="'+this.dateRangeDiv+'" >','<input type="text" class="gri_dateRangeInput" name="'+this.startDateId+'" id="'+this.startDateId+'" value="'+this.mOpts.startDate+'" readonly />','<span id="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="gri_dateRangeInput" name="'+this.endDateId+'" id="'+this.endDateId+'" value="'+this.mOpts.endDate+'" readonly /><br />',"</div>",'<div class="gri_dateRangeInput" id="'+this.dateRangeCompareDiv+'">','<input type="text" class="gri_dateRangeInput" name="'+this.startCompareDateId+'" id="'+this.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="gri_dateRangeInput" name="'+this.endCompareDateId+'" id="'+this.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" readonly />',"</div>","<div>",'<input type="button" name="'+this.submitBtn+'" id="'+this.submitBtn+'" value="确定" />','&nbsp;<a id="'+this.closeBtn+'" href="javascript:;">关闭</a>',"</div>","</div>","</div>"],ta:['<div id="'+this.calendarId+'" class="ta_calendar ta_calendar2 cf" style="margin-top:80px;">','<header class="mui-bar mui-bar-nav"><a class="mui-icon mui-icon-arrowleft mui-pull-left closeCalendar"></a><h1 class="mui-title">日期选择</h1></header>','<ul class="weekhead"><li>日</li><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li></ul>','<div class="ta_calendar_cont cf" id="'+this.dateListId+'">',"</div>",'<div class="ta_calendar_footer cf" '+(this.mOpts.autoSubmit?' style="display:none" ':"")+">",'<div class="frm_msg">','<div id="'+this.dateRangeDiv+'">','<input type="text" class="ta_ipt_text_s" name="'+this.startDateId+'" id="'+this.startDateId+'" value="'+this.mOpts.startDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="ta_ipt_text_s" name="'+this.endDateId+'" id="'+this.endDateId+'" value="'+this.mOpts.endDate+'" readonly /><br />',"</div>",'<div id="'+this.dateRangeCompareDiv+'">','<input type="text" class="ta_ipt_text_s" name="'+this.startCompareDateId+'" id="'+this.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" readonly />','<span class="'+this.mOpts.joinLineId+'"> - </span>','<input type="text" class="ta_ipt_text_s" name="'+this.endCompareDateId+'" id="'+this.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" readonly />',"</div>","</div>",'<div class="frm_btn">','<input class="ta_btn ta_btn_primary" type="button" name="'+this.submitBtn+'" id="'+this.submitBtn+'" value="确定" />','<input class="ta_btn" type="button" id="'+this.closeBtn+'" value="取消"/>',"</div>","</div>","</div>"]},p={gri:['<label class="gri_contrast" for ="'+this.compareCheckboxId+'">','<input type="checkbox" class="gri_pc" name="'+this.compareCheckboxId+'" id="'+this.compareCheckboxId+'" value="1"/>对比',"</label>",'<input type="text" name="'+this.inputCompareId+'" id="'+this.inputCompareId+'" value="" class="gri_date"/>'],ta:['<label class="contrast" for ="'+this.compareCheckboxId+'">','<input type="checkbox" class="pc" name="'+this.compareCheckboxId+'" id="'+this.compareCheckboxId+'" value="1"/>对比',"</label>",'<div class="ta_date" id="'+this.compareInputDiv+'">','\t<span name="dateCompare" id="'+this.inputCompareId+'" class="date_title"></span>','\t<a class="opt_sel" id="'+this.mOpts.compareTrigger+'" href="#">','\t\t<i class="i_orderd"></i>',"\t</a>","</div>"]};"ta"==this.mOpts.theme?$(p[this.mOpts.theme].join("")).insertAfter($("#div_"+this.inputId)):$(p[this.mOpts.theme].join("")).insertAfter($("#"+this.inputId)),this.mOpts.noCalendar&&($("#"+this.inputId).css("display","none"),$("#"+this.compareCheckboxId).parent().css("display","none")),$(0<$("#appendParent").length?"#appendParent":document.body).append(o[this.mOpts.theme].join("")),$("#"+this.calendarId).css("z-index",9999),1>$("#"+this.mOpts.startDateId).length?$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.startDateId+'" name="'+this.mOpts.startDateId+'" value="'+this.mOpts.startDate+'" />'):$("#"+this.mOpts.startDateId).val(this.mOpts.startDate),1>$("#"+this.mOpts.endDateId).length?$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.endDateId+'" name="'+this.mOpts.endDateId+'" value="'+this.mOpts.endDate+'" />'):$("#"+this.mOpts.endDateId).val(this.mOpts.endDate),1>$("#"+this.mOpts.compareCheckboxId).length&&$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="checkbox" id="'+this.mOpts.compareCheckboxId+'" name="'+this.mOpts.compareCheckboxId+'" value="0" style="display:none;" />'),0==this.mOpts.needCompare?($("#"+this.compareInputDiv).css("display","none"),$("#"+this.compareCheckBoxDiv).css("display","none"),$("#"+this.dateRangeCompareDiv).css("display","none"),$("#"+this.compareCheckboxId).attr("disabled",!0),$("#"+this.startCompareDateId).attr("disabled",!0),$("#"+this.endCompareDateId).attr("disabled",!0),$("#"+this.compareCheckboxId).parent().css("display","none"),$("#"+this.mOpts.replaceBtn).length>0&&$("#"+this.mOpts.replaceBtn).hide()):(1>$("#"+this.mOpts.startCompareDateId).length?$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.startCompareDateId+'" name="'+this.mOpts.startCompareDateId+'" value="'+this.mOpts.startCompareDate+'" />'):$("#"+this.mOpts.startCompareDateId).val(this.mOpts.startCompareDate),1>$("#"+this.mOpts.endCompareDateId).length?$(""!=this.mOpts.target?"#"+this.mOpts.target:"body").append('<input type="hidden" id="'+this.mOpts.endCompareDateId+'" name="'+this.mOpts.endCompareDateId+'" value="'+this.mOpts.endCompareDate+'" />'):$("#"+this.mOpts.endCompareDateId).val(this.mOpts.endCompareDate),""==this.mOpts.startCompareDate||""==this.mOpts.endCompareDate?($("#"+this.compareCheckboxId).attr("checked",!1),$("#"+this.mOpts.compareCheckboxId).attr("checked",!1)):($("#"+this.compareCheckboxId).attr("checked",!0),$("#"+this.mOpts.compareCheckboxId).attr("checked",!0))),this.dateInput=this.startDateId,this.changeInput(this.dateInput),$("#"+this.startDateId).bind("click",function(){return l.endCompareDateId==l.dateInput&&$("#"+l.startCompareDateId).val(l.startDefDate),l.startDefDate="",l.removeCSS(1),l.changeInput(l.startDateId),!1}),$("#"+this.calendarId).bind("click",function(a){a.stopPropagation()}),$("#"+this.startCompareDateId).bind("click",function(){return l.endDateId==l.dateInput&&$("#"+l.startDateId).val(l.startDefDate),l.startDefDate="",l.removeCSS(0),l.changeInput(l.startCompareDateId),!1}),$(".closeCalendar").on("click",function(){l.close(1)}),$("#"+this.submitBtn).bind("click",function(){return l.close(1),l.mOpts.success({startDate:$("#"+l.mOpts.startDateId).val(),endDate:$("#"+l.mOpts.endDateId).val(),needCompare:$("#"+l.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+l.mOpts.startCompareDateId).val(),endCompareDate:$("#"+l.mOpts.endCompareDateId).val()}),!1}),$("#"+this.closeBtn).bind("click",function(){return l.close(),!1}),$("#"+this.inputId).bind("click",function(){if(l.mOpts.initBefore())return d(),l.init(),l.show(!1,l),e(),!1}),$(".btn-date-selected").bind("click",function(){if(l.mOpts.initBefore())return d(),l.init(),l.show(!1,l),e(),!1}),$("#"+this.mOpts.inputTrigger).bind("click",function(){if(l.mOpts.initBefore())return d(),l.init(),l.show(!1,l),e(),!1}),$("#"+this.mOpts.compareTrigger).bind("click",function(){return l.init(!0),l.show(!0,l),e(),!1}),$("#"+this.inputCompareId).bind("click",function(){return l.init(!0),l.show(!0,l),e(),!1}),this.mOpts.singleCompare&&("ta"===this.mOpts.theme?($("#"+l.startDateId).val(l.mOpts.startDate),$("#"+l.endDateId).val(l.mOpts.startDate),$("#"+l.startCompareDateId).val(l.mOpts.startCompareDate),$("#"+l.endCompareDateId).val(l.mOpts.startCompareDate)):($("#"+l.startDateId).val(l.mOpts.startDate),$("#"+l.endDateId).val(l.mOpts.startDate),$("#"+l.startCompareDateId).val(l.mOpts.startCompareDate),$("#"+l.endCompareDateId).val(l.mOpts.startCompareDate),$("#"+this.compareCheckboxId).attr("checked",!0),$("#"+this.mOpts.compareCheckboxId).attr("checked",!0))),$("#"+this.dateRangeCompareDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none"),$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none"),$("#"+this.compareCheckboxId).bind("click",function(){$("#"+l.inputCompareId).css("display",this.checked?"":"none"),$("#"+l.dateRangeCompareDiv).css("display",this.checked?"":"none"),$("#"+l.compareInputDiv).css("display",this.checked?"":"none"),$("#"+l.startCompareDateId).css("disabled",!this.checked),$("#"+l.endCompareDateId).css("disabled",!this.checked),$("#"+l.mOpts.compareCheckboxId).attr("checked",$("#"+l.compareCheckboxId).attr("checked")),$("#"+l.mOpts.compareCheckboxId).val($("#"+l.compareCheckboxId).attr("checked")?1:0),$("#"+l.compareCheckboxId).attr("checked")?(sDate=l.str2date($("#"+l.startDateId).val()),sTime=sDate.getTime(),eDate=l.str2date($("#"+l.endDateId).val()),eTime=eDate.getTime(),scDate=$("#"+l.startCompareDateId).val(),ecDate=$("#"+l.endCompareDateId).val(),""!=scDate&&""!=ecDate||(ecDate=l.str2date(l.date2ymd(sDate).join("-")),ecDate.setDate(ecDate.getDate()-1),scDate=l.str2date(l.date2ymd(sDate).join("-")),scDate.setDate(scDate.getDate()-(eTime-sTime)/864e5-1),ecDate.getTime()<1e3*l.mOpts.minValidDate&&(scDate=sDate,ecDate=eDate),ecDate.getTime()>=1e3*l.mOpts.minValidDate&&scDate.getTime()<1e3*l.mOpts.minValidDate&&(scDate.setTime(1e3*l.mOpts.minValidDate),scDate=l.str2date(l.date2ymd(scDate).join("-")),ecDate.setDate(scDate.getDate()+(eTime-sTime)/864e5-1)),$("#"+l.startCompareDateId).val(l.formatDate(l.date2ymd(scDate).join("-"))),$("#"+l.endCompareDateId).val(l.formatDate(l.date2ymd(ecDate).join("-")))),l.addCSS(1),l.changeInput(l.startCompareDateId)):(l.removeCSS(1),l.changeInput(l.startDateId)),l.close(1),l.mOpts.success({startDate:$("#"+l.mOpts.startDateId).val(),endDate:$("#"+l.mOpts.endDateId).val(),needCompare:$("#"+l.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+l.mOpts.startCompareDateId).val(),endCompareDate:$("#"+l.mOpts.endCompareDateId).val()})}),this.init(),this.close(1),this.mOpts.replaceBtn&&$("#"+this.mOpts.replaceBtn).length>0&&($("#"+l.compareCheckboxId).hide(),$(".contrast").hide(),$("#"+this.mOpts.replaceBtn).bind("click",function(){var a=this;$("#"+l.compareCheckboxId).attr("checked")?$("#"+l.compareCheckboxId).removeAttr("checked"):$("#"+l.compareCheckboxId).attr("checked","checked"),$("#"+l.compareCheckboxId).click(),$("#"+l.compareCheckboxId).attr("checked")?function(){$("#"+l.compareCheckboxId).removeAttr("checked"),$(".contrast").hide(),$(a).text("按时间对比")}():function(){$("#"+l.compareCheckboxId).attr("checked","checked"),$(".contrast").show(),$(a).text("取消对比")}()})),this.mOpts.autoCommit&&this.mOpts.success({startDate:$("#"+l.mOpts.startDateId).val(),endDate:$("#"+l.mOpts.endDateId).val(),needCompare:$("#"+l.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+l.mOpts.startCompareDateId).val(),endCompareDate:$("#"+l.mOpts.endCompareDateId).val()}),$(document).bind("click",function(){l.close()})}pickerDateRange.prototype.init=function(a){var b=this,c="undefined"!=typeof a?a&&$("#"+b.compareCheckboxId).attr("checked"):$("#"+b.compareCheckboxId).attr("checked");$("#"+this.dateListId).empty();var d=""==this.mOpts.endDate?new Date:this.str2date(this.mOpts.endDate),e=""==this.mOpts.startDate?new Date:this.str2date(this.mOpts.startDate);if(this.calendar_endDate=new Date(d.getFullYear(),d.getMonth(),0),this.mOpts.magicSelect&&"ta"==this.mOpts.theme){var f=0;do{var g=null;if(0==f)g=this.fillDate(this.str2date($("#"+this.endDateId).val()).getFullYear(),this.str2date($("#"+this.endDateId).val()).getMonth(),f),$("#"+this.dateListId).append(g);else{g=this.fillDate(this.str2date($("#"+this.startDateId).val()).getFullYear(),this.str2date($("#"+this.startDateId).val()).getMonth(),f);var h="ta"==this.mOpts.theme?$("#"+this.dateListId).find("table").get(0):$("#"+this.dateListId).find("td").get(0);$(h).before(g)}f++}while(f<2);this.calendar_startDate=new Date(this.str2date($("#"+this.startDateId).val()).getFullYear(),this.str2date($("#"+this.startDateId).val()).getMonth(),1)}else{for(var f=0;f<this.mOpts.calendars;f++){var g=null;if("ta"==this.mOpts.theme?g=this.fillDate(e.getFullYear(),e.getMonth(),f):(g=document.createElement("td"),$(g).append(this.fillDate(e.getFullYear(),e.getMonth(),f)),$(g).css("vertical-align","top")),0==f)$("#"+this.dateListId).append(g);else{var h="ta"==this.mOpts.theme?$("#"+this.dateListId).get(0):$("#"+this.dateListId).find("td").get(0);$(h).append(g)}e.setMonth(e.getMonth()+1,1)}this.calendar_startDate=new Date(e.getFullYear(),e.getMonth(),1)}this.mOpts.isMonthBeyond||$(".mbefore,.mafter").html(""),$("#"+this.preMonth).bind("click",function(){return b.calendar_startDate.setMonth(b.calendar_startDate.getMonth()-b.mOpts.calendars-1,1),b.mOpts.startDate=b.date2ymd(b.calendar_startDate).join("-"),b.init(a),1==b.mOpts.calendars&&(""==$("#"+b.startDateId).val()?b.changeInput(b.startDateId):b.changeInput(b.endDateId)),!1}),$("#"+this.nextMonth).bind("click",function(){return b.calendar_startDate.setMonth(b.calendar_startDate.getMonth()-b.mOpts.calendars+1,1),b.mOpts.startDate=b.date2ymd(b.calendar_startDate).join("-"),b.init(a),1==b.mOpts.calendars&&(""==$("#"+b.startDateId).val()?b.changeInput(b.startDateId):b.changeInput(b.endDateId)),!1}),this.mOpts.magicSelect&&this.bindChangeForSelect(),this.endDateId!=this.dateInput&&this.endCompareDateId!=this.dateInput&&(c&&"undefined"!=typeof a?this.addCSS(1):this.addCSS(0)),c&&"undefined"!=typeof a?b.addCSS(1):b.addCSS(0),$("#"+b.inputCompareId).css("display",c?"":"none"),$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none");for(var i in b.periodObj)$("#"+i).length>0&&($("#"+i).unbind("click"),$("#"+i).bind("click",function(){var a="ta"==b.mOpts.theme?"active":"a";$(this).parent().nextAll().removeClass(a),$(this).parent().prevAll().removeClass(a),$(this).parent().addClass(a);var c=b.getSpecialPeriod(b.periodObj[$(this).attr("id")]);$("#"+b.startDateId).val(b.formatDate(c.otherday)),$("#"+b.endDateId).val(b.formatDate(c.today)),$("#"+b.mOpts.startDateId).val($("#"+b.startDateId).val()),$("#"+b.mOpts.endDateId).val($("#"+b.endDateId).val()),"ta"==b.mOpts.theme?$("#"+b.compareInputDiv).hide():$("#"+b.inputCompareId).css("display","none"),$("#"+b.compareCheckboxId).attr("checked",!1),$("#"+b.mOpts.compareCheckboxId).attr("checked",!1),$("#"+this.compareInputDiv).css("display",$("#"+this.compareCheckboxId).attr("checked")?"":"none"),b.close(1),$("#"+b.startCompareDateId).val(""),$("#"+b.endCompareDateId).val(""),$("#"+b.mOpts.startCompareDateId).val(""),$("#"+b.mOpts.endCompareDateId).val(""),$("#"+b.mOpts.compareCheckboxId).val(0),$("#"+b.mOpts.replaceBtn).length>0&&($(".contrast").hide(),$("#"+b.mOpts.replaceBtn).text("按时间对比")),b.mOpts.success({startDate:$("#"+b.mOpts.startDateId).val(),endDate:$("#"+b.mOpts.endDateId).val(),needCompare:$("#"+b.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+b.mOpts.startCompareDateId).val(),endCompareDate:$("#"+b.mOpts.endCompareDateId).val()})}));$(document).bind("click",function(){b.close()}),$("#"+this.inputId).bind("change",function(){""===$(this).val()&&($("#"+b.startDateId).val(""),$("#"+b.endDateId).val(""),$("#"+b.startCompareDateId).val(""),$("#"+b.endCompareDateId).val(""))})},pickerDateRange.prototype.bindChangeForSelect=function(){var a=this,b=function(a,b,c,d){function e(){$("#"+b).removeClass(d)}function f(){$("#"+b).addClass(d)}function g(){return $("#"+b).attr("class")==d}d=d||"open";var h=null,i=500;$("#"+a).click(function(){g()?e():f()}).mouseover(function(){clearTimeout(h)}).mouseout(function(){h=setTimeout(e,i)}),$("#"+c).mouseover(function(){clearTimeout(h)}).mouseout(function(){h=setTimeout(e,i)})};try{$("#"+this.dateListId).find('div[id*="selected"]').each(function(){var c=$(this).attr("id").match(/(\w+)_(\d)/i);if(c){var d=c[1],e=c[2];"yselected"==d?b("_ybtn_"+e,$(this).attr("id"),"_yctn_"+e):"mselected"==d&&b("_mbtn_"+e,$(this).attr("id"),"_mctn_"+e),$(this).find("li a").each(function(){$(this).click(function(){var b=$(this).parents(".select_wrap").attr("id").match(/(\w+)_(\d)/i),c=b[1],d=b[2],e=null;d^!1?("yselected"==c?a.calendar_startDate.setYear(1*$(this).text(),1):(c="mselected")&&a.calendar_startDate.setMonth(1*$(this).text()-1,1),a.mOpts.startDate=a.date2ymd(a.calendar_startDate).join("-"),e=a.fillDate(a.calendar_startDate.getFullYear(),a.calendar_startDate.getMonth(),d)):("yselected"==c?a.calendar_endDate.setYear(1*$(this).text(),1):(c="mselected")&&a.calendar_endDate.setMonth(1*$(this).text()-1,1),a.mOpts.endDate=a.date2ymd(a.calendar_endDate).join("-"),e=a.fillDate(a.calendar_endDate.getFullYear(),a.calendar_endDate.getMonth(),d));var f=$("#"+a.dateListId).find("table").get(1^d);$(f).replaceWith(e),a.removeCSS(0),a.bindChangeForSelect()})})}})}catch(a){window.console&&console.log(a)}},pickerDateRange.prototype.getSpecialPeriod=function(a){var b=this,c=new Date;1==b.mOpts.isTodayValid&&""!=b.mOpts.isTodayValid||2>a?"":c.setTime(c.getTime()-864e5);var d=c.getTime()-24*a*60*60*1e3<1e3*b.mOpts.minValidDate?1e3*b.mOpts.minValidDate:c.getTime()-24*a*60*60*1e3,e=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();c.setTime(d);var f=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();return a==b.periodObj.aYesterday&&(e=f),{today:e,otherday:f}},pickerDateRange.prototype.getCurrentDate=function(){return{startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()}},pickerDateRange.prototype.removeCSS=function(a,b){"undefined"==typeof b&&(b=this.mOpts.theme+"_"+this.mOpts.coincideCss),"undefined"==typeof a&&(a=0);var c=this.calendar_startDate,d=this.calendar_endDate;this.mOpts.magicSelect&&(c=this.str2date($("#"+this.startDateId).val()),d=this.str2date($("#"+this.endDateId).val()));for(var e=new Date(c.getFullYear(),c.getMonth(),c.getDate()),f="",g=new Date(e);g.getTime()<=d.getTime();g.setDate(g.getDate()+1))f=0==a?this.mOpts.theme+"_"+this.mOpts.selectCss:this.mOpts.theme+"_"+this.mOpts.compareCss,$("#"+this.calendarId+"_"+this.date2ymd(g).join("-")).removeClass(f),$("#"+this.calendarId+"_"+this.date2ymd(g).join("-")).removeClass(this.mOpts.firstCss).removeClass(this.mOpts.lastCss).removeClass(this.mOpts.clickCss)},pickerDateRange.prototype.addCSS=function(a,b){"undefined"==typeof b&&(b=this.mOpts.theme+"_"+this.mOpts.coincideCss),"undefined"==typeof a&&(a=0);for(var c=this.str2date($("#"+this.startDateId).val()),d=this.str2date($("#"+this.endDateId).val()),e=this.str2date($("#"+this.startCompareDateId).val()),f=this.str2date($("#"+this.endCompareDateId).val()),g=0==a?c:e,h=0==a?d:f,i="",j=new Date(g);j.getTime()<=h.getTime();j.setDate(j.getDate()+1))0==a?(i=this.mOpts.theme+"_"+this.mOpts.selectCss,$("#"+this.calendarId+"_"+this.date2ymd(j).join("-")).removeClass(this.mOpts.firstCss).removeClass(this.mOpts.lastCss).removeClass(this.mOpts.clickCss),$("#"+this.calendarId+"_"+this.date2ymd(j).join("-")).removeClass(i)):i=this.mOpts.theme+"_"+this.mOpts.compareCss,$("#"+this.calendarId+"_"+this.date2ymd(j).join("-")).attr("class",i);"ta"==this.mOpts.theme&&($("#"+this.calendarId+"_"+this.date2ymd(new Date(g)).join("-")).removeClass().addClass(this.mOpts.firstCss),$("#"+this.calendarId+"_"+this.date2ymd(new Date(h)).join("-")).removeClass().addClass(this.mOpts.lastCss),g.getTime()==h.getTime()&&$("#"+this.calendarId+"_"+this.date2ymd(new Date(h)).join("-")).removeClass().addClass(this.mOpts.clickCss),1==this.mOpts.isSingleDay&&g.getTime()==h.getTime()&&$("#"+this.calendarId+"_"+this.date2ymd(new Date(h)).join("-")).addClass("singleToday"))},pickerDateRange.prototype.checkDateRange=function(a,b){var c,d=this.str2date(a),e=this.str2date(b),f=d.getTime(),g=e.getTime();if(console.log(f),console.log(g),g>=f){if(c=this.str2date(a),c.setMonth(c.getMonth()+this.mOpts.monthRangeMax),c.setDate(c.getDate()+this.mOpts.dayRangeMax-1),c.getTime()<g)return alert("结束日期不能大于："+this.date2ymd(c).join("-")),!1}else if(c=this.str2date(b),c.setMonth(c.getMonth()-this.mOpts.monthRangeMax),c.setDate(c.getDate()-this.mOpts.dayRangeMax+1),c.getTime()>g)return alert("开始日期不能小于："+this.date2ymd(c).join("-")),!1;return g!=f},pickerDateRange.prototype.selectDate=function(a){this.changeInput(this.dateInput);var b=this.formatDate(a);if(this.startDateId==this.dateInput)this.removeCSS(0),this.removeCSS(1),$("#"+this.calendarId+"_"+a).attr("class","ta"==this.mOpts.theme?this.mOpts.clickCss:this.mOpts.theme+"_"+this.mOpts.selectCss),this.startDefDate=$("#"+this.dateInput).val(),$("#"+this.dateInput).val(b),1==this.mOpts.singleCompare||1==this.mOpts.isSingleDay?(this.dateInput=this.startDateId,$("#"+this.endDateId).val(b),(this.mOpts.shortOpr||this.mOpts.autoSubmit)&&this.close(1),this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()})):this.dateInput=this.endDateId;else if(this.endDateId==this.dateInput){if(""==$("#"+this.startDateId).val())return this.dateInput=this.startDateId,this.selectDate(a),!1;0==this.checkDateRange($("#"+this.startDateId).val(),a),-1==this.compareStrDate(a,$("#"+this.startDateId).val())&&($("#"+this.dateInput).val($("#"+this.startDateId).val()),$("#"+this.startDateId).val(b),b=$("#"+this.dateInput).val()),$("#"+this.dateInput).val(b),this.dateInput=this.startDateId,this.removeCSS(0),this.addCSS(0),this.startDefDate="",this.mOpts.autoSubmit&&(this.close(1),this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()}))}else if(this.startCompareDateId==this.dateInput)this.removeCSS(1),this.removeCSS(0),$("#"+this.calendarId+"_"+a).attr("class","ta"==this.mOpts.theme?this.mOpts.clickCss:this.mOpts.theme+"_"+this.mOpts.compareCss),this.startDefDate=$("#"+this.dateInput).val(),$("#"+this.dateInput).val(b),1==this.mOpts.singleCompare||1==this.mOpts.isSingleDay?(this.dateInput=this.startCompareDateId,$("#"+this.endCompareDateId).val(b),(this.mOpts.shortOpr||this.mOpts.autoSubmit)&&this.close(1),this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()})):this.dateInput=this.endCompareDateId;else if(this.endCompareDateId==this.dateInput){if(""==$("#"+this.startCompareDateId).val())return this.dateInput=this.startCompareDateId,this.selectDate(a),!1;if(0==this.checkDateRange($("#"+this.startCompareDateId).val(),a))return!1;-1==this.compareStrDate(a,$("#"+this.startCompareDateId).val())&&($("#"+this.dateInput).val($("#"+this.startCompareDateId).val()),$("#"+this.startCompareDateId).val(b),b=$("#"+this.dateInput).val()),$("#"+this.dateInput).val(b),this.dateInput=this.startCompareDateId,this.removeCSS(1),this.addCSS(1),this.startDefDate="",this.mOpts.autoSubmit&&(this.close(1),this.mOpts.success({startDate:$("#"+this.mOpts.startDateId).val(),endDate:$("#"+this.mOpts.endDateId).val(),needCompare:$("#"+this.mOpts.compareCheckboxId).val(),startCompareDate:$("#"+this.mOpts.startCompareDateId).val(),endCompareDate:$("#"+this.mOpts.endCompareDateId).val()}))}},pickerDateRange.prototype.show=function(a,b){$("#"+b.dateRangeDiv).css("display",a?"none":""),$("#"+b.dateRangeCompareDiv).css("display",a?"":"none");var c=a?$("#"+this.inputCompareId).offset():$("#"+this.inputId).offset(),d=(a?$("#"+this.inputCompareId).height():$("#"+this.inputId).height(),parseInt($(document.body)[0].clientWidth)),e=c.left;return $("#"+this.calendarId).css("display","block"),1!=this.mOpts.singleCompare&&1!=this.mOpts.isSingleDay||($("#"+this.endDateId).css("display","none"),$("#"+this.endCompareDateId).css("display","none"),$("#"+this.mOpts.joinLineId).css("display","none"),$("."+this.mOpts.joinLineId).css("display","none")),0<d&&$("#"+this.calendarId).width()+c.left>d&&(e=c.left+$("#"+this.inputId).width()-$("#"+this.calendarId).width()+(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?5:0),"ta"==b.mOpts.theme&&(e+=50)),$("#"+this.calendarId).css("left",e+"px"),$("#"+this.calendarId).css("top",c.top+("ta"==b.mOpts.theme?35:22)+"px"),a?this.changeInput(this.startCompareDateId):this.changeInput(this.startDateId),!1},pickerDateRange.prototype.close=function(a){var b=this;if(a){this.mOpts.shortOpr===!0?($("#"+this.inputId).val($("#"+this.startDateId).val()),$("#"+this.inputCompareId).val($("#"+this.startCompareDateId).val())):$("#"+this.inputId).val($("#"+this.startDateId).val()+(""==$("#"+this.endDateId).val()?"":this.mOpts.defaultText+$("#"+this.endDateId).val()));var c=1==this.mOpts.isTodayValid&&""!=this.mOpts.isTodayValid?(new Date).getTime():(new Date).getTime()-864e5,d=this.str2date($("#"+this.startDateId).val()).getTime(),e=this.str2date($("#"+this.endDateId).val()).getTime();if(e<d){var f=$("#"+this.startDateId).val();$("#"+this.startDateId).val($("#"+this.endDateId).val()),$("#"+this.endDateId).val(f)}var g=1==this.mOpts.shortOpr?$("#"+this.startDateId).val():$("#"+this.startDateId).val()+(""==$("#"+this.endDateId).val()?"":this.mOpts.defaultText+$("#"+this.endDateId).val()),h=document.getElementById(this.inputId);if(h&&"INPUT"==h.tagName?($("#"+this.inputId).val(g),$("#"+this.inputCompareId).is(":visible")&&$("#"+this.inputCompareId).val(l)):($("#"+this.inputId).html(g),$("#"+this.inputCompareId).is(":visible")&&$("#"+this.inputCompareId).html(l)),"ta"!=this.mOpts.theme&&""!=$("#"+this.startCompareDateId).val()&&""!=$("#"+this.endCompareDateId).val()){var i=this.str2date($("#"+this.startCompareDateId).val()).getTime(),j=this.str2date($("#"+this.endCompareDateId).val()).getTime(),k=i+e-d;k>c&&(k=c,$("#"+this.startCompareDateId).val(this.formatDate(this.date2ymd(new Date(k+d-e)).join("-")))),$("#"+this.endCompareDateId).val(this.formatDate(this.date2ymd(new Date(k)).join("-")));var i=this.str2date($("#"+this.startCompareDateId).val()).getTime(),j=this.str2date($("#"+this.endCompareDateId).val()).getTime();if(j<i){var f=$("#"+this.startCompareDateId).val();$("#"+this.startCompareDateId).val($("#"+this.endCompareDateId).val()),$("#"+this.endCompareDateId).val(f)}}var l=1==this.mOpts.shortOpr?$("#"+this.startCompareDateId).val():$("#"+this.startCompareDateId).val()+(""==$("#"+this.endCompareDateId).val()?"":this.mOpts.defaultText+$("#"+this.endCompareDateId).val());h&&"INPUT"==h.tagName?$("#"+this.inputCompareId).val(l):$("#"+this.inputCompareId).html(l);$("#"+this.mOpts.startDateId).val($("#"+this.startDateId).val()),$("#"+this.mOpts.endDateId).val($("#"+this.endDateId).val()),$("#"+this.mOpts.startCompareDateId).val($("#"+this.startCompareDateId).val()),$("#"+this.mOpts.endCompareDateId).val($("#"+this.endCompareDateId).val());for(var m in this.periodObj)$("#"+this.mOpts[m])&&$("#"+this.mOpts[m]).parent().removeClass("a")}return $("#"+b.calendarId).css("display","none"),!1},pickerDateRange.prototype.fillDate=function(a,b,c){
var d=this,e="ta"==this.mOpts.theme,f=new Date(a,b,1),g=new Date(a,b,1),h=g.getDay();g.setDate(1-h);var i=new Date(a,b+1,0),j=new Date(a,b+1,0);h=j.getDay(),j.setDate(j.getDate()+6-h);var k=new Date,l=k.getDate(),m=k.getMonth(),n=k.getFullYear(),o=document.createElement("table");if(e){if(o.className=this.mOpts.dateTable,cap=document.createElement("caption"),this.mOpts.magicSelect){var p=['<div class="select_wrap" id="yselected_'+c+'"><div class="select" id="_ybtn_'+c+'">'+a+'</div><div class="dropdown" id="_yctn_'+c+'"><ul class="list_menu">'],q=['<div class="select_wrap" id="mselected_'+c+'"><div class="select" id="_mbtn_'+c+'">'+(b+1)+'</div><div class="dropdown" id="_mctn_'+c+'"><ul class="list_menu">'];s=1,yt=n;do p.push('<li><a href="javascript:;">'+yt--+"</a></li>"),q.push('<li><a href="javascript:;">'+s++ +"</a></li>");while(s<=12);p.push("</ul></div></div>"),q.push("</ul></div></div>"),$(cap).append(p.join("")+'<span class="joinLine"> 年 </span>'+q.join("")+'<span class="joinLine"> 月 </span>')}else $(cap).append('<div class="captionTit"><label>'+a+"年"+(b+1)+"月</label></div>");$(o).append(cap),thead=document.createElement("thead"),tr=document.createElement("tr");for(var r=["日","一","二","三","四","五","六"],s=0;s<7;s++)th=document.createElement("th"),$(th).append(r[s]),$(tr).append(th);tr=document.createElement("tr"),td=document.createElement("td"),this.mOpts.magicSelect||(0==c&&$(td).append('<a href="javascript:void(0);" id="'+this.nextMonth+'"><i class="i_next"></i></a>'),c+1==this.mOpts.calendars&&$(td).append('<a href="javascript:void(0);" id="'+this.preMonth+'"><i class="i_pre"></i></a>')),$(td).attr("colSpan",7),$(td).css("text-align","center"),$(tr).append(td),this.mOpts.isSelectBtn&&$(o).append(tr)}else{o.className=this.mOpts.theme+"_"+this.mOpts.dateTable,tr=document.createElement("tr"),td=document.createElement("td"),0==c&&$(td).append('<a href="javascript:void(0);" id="'+this.nextMonth+'" class="gri_dateRangeNextMonth"><span>next</span></a>'),c+1==this.mOpts.calendars&&$(td).append('<a href="javascript:void(0);" id="'+this.preMonth+'" class="gri_dateRangePreMonth"><span>pre</span></a>'),$(td).append(a+"年"+(b+1)+"月"),$(td).attr("colSpan",7),$(td).css("text-align","center"),$(td).css("background-color","#F9F9F9"),$(tr).append(td),$(o).append(tr);var r=["日","一","二","三","四","五","六"];tr=document.createElement("tr");for(var s=0;s<7;s++)td=document.createElement("td"),$(td).append(r[s]),$(tr).append(td);$(o).append(tr)}for(var t="",u=0,v="",w=g;w.getTime()<=j.getTime();w.setDate(w.getDate()+1)){if(w.getTime()<f.getTime())t=this.mOpts.theme+"_"+this.mOpts.disableGray+" mbefore",u="-1";else if(w.getTime()>i.getTime())t=this.mOpts.theme+"_"+this.mOpts.disableGray+" mafter",u="1";else if(1==this.mOpts.stopToday&&w.getTime()>k.getTime()||w.getTime()<1e3*d.mOpts.minValidDate||""!==d.mOpts.maxValidDate&&w.getTime()>1e3*d.mOpts.maxValidDate)t=this.mOpts.theme+"_"+this.mOpts.disableGray,u="2";else{if(u="0",w.getDate()==l&&w.getMonth()==m&&w.getFullYear()==n?1==this.mOpts.isTodayValid?t=this.mOpts.theme+"_"+this.mOpts.isToday:(t=this.mOpts.theme+"_"+this.mOpts.disableGray,u="2"):1==d.mOpts.selectRanged&&(d.mOpts.selectRangedStart>w.getTime()||d.mOpts.selectRangedEnd<w.getTime())?(t=this.mOpts.theme+"_"+this.mOpts.disableGray,u="2"):t="",!this.mOpts.weekendDis||6!=w.getDay()&&0!=w.getDay()||(t=this.mOpts.theme+"_"+this.mOpts.disableGray,u="3"),this.mOpts.disCertainDay&&this.mOpts.disCertainDay.length>0)for(var x in this.mOpts.disCertainDay)isNaN(this.mOpts.disCertainDay[x])||w.getDay()!==this.mOpts.disCertainDay[x]||(t=this.mOpts.theme+"_"+this.mOpts.disableGray,u="4");if(this.mOpts.disCertainDate&&this.mOpts.disCertainDate.length>0){var y=!1;for(var x in this.mOpts.disCertainDate)if(!isNaN(this.mOpts.disCertainDate[x])||isNaN(parseInt(this.mOpts.disCertainDate[x])))if(this.mOpts.disCertainDate[0]===!0){if(y=!(w.getDate()===this.mOpts.disCertainDate[x]),!y)break}else if(y=!(w.getDate()!==this.mOpts.disCertainDate[x]))break;y&&(t=this.mOpts.theme+"_"+this.mOpts.disableGray,u="4")}}0==w.getDay()&&(tr=document.createElement("tr")),td=document.createElement("td"),tdGetdate=w.getDate();var z=d.getLunarDate(w.getFullYear(),w.getMonth()+1,w.getDate());""!=z.gfestival&&(tdGetdate=z.gfestival);var A=new Date;w.getFullYear()==A.getFullYear()&&w.getMonth()==A.getMonth()&&w.getDate()==A.getDate()?td.innerHTML='<span class="gday">今天</span><br/><span class="nlunar">'+z.soday+"</span>":td.innerHTML='<span class="gday">'+tdGetdate+'</span><br/><span class="nlunar">'+z.soday+"</span>",""!=z.gfestival&&$(td).find(".gday").attr("style","font-size:12px;"),""!=t&&$(td).attr("class",t),0==u&&(v=w.getFullYear()+"-"+(w.getMonth()+1)+"-"+w.getDate(),$(td).attr("id",d.calendarId+"_"+v),$(td).css("cursor","pointer"),function(a){$(td).bind("click",a,function(){return d.selectDate(a),d.mOpts.isSingleDay&&(d.mOpts.realstartVal=a),!1})}(v)),$(tr).append(td),6==w.getDay()&&$(o).append(tr)}return o},pickerDateRange.prototype.str2date=function(a){var b=a.split("-");return new Date(b[0],b[1]-1,b[2])},pickerDateRange.prototype.IsDate=function(a,b){var c=/^(\d{4})-(\d{2})-(\d{2})$/,d=b;c.exec(d);return""==d||(!(!c.test(d)&&RegExp.$2<=12&&RegExp.$3<=31)||(alert("请核对 "+a+" 输入的日期格式为yyyy-mm-dd"),!1))},pickerDateRange.prototype.compareStrDate=function(a,b){var c=this.str2date(a),d=this.str2date(b);return c.getTime()>d.getTime()?1:c.getTime()==d.getTime()?0:-1},pickerDateRange.prototype.date2ymd=function(a){return[a.getFullYear(),a.getMonth()+1,a.getDate()]},pickerDateRange.prototype.changeInput=function(a){1==this.mOpts.isSingleDay&&(a=this.startDateId);var b=[this.startDateId,this.startCompareDateId,this.endDateId,this.endCompareDateId],c="";c=a==this.startDateId||a==this.endDateId?this.mOpts.theme+"_"+this.mOpts.selectCss:this.mOpts.theme+"_"+this.mOpts.compareCss,a==this.endDateId&&this.mOpts.singleCompare&&(c=this.mOpts.theme+"_"+this.mOpts.compareCss);for(var d in b)$("#"+b[d]).removeClass(this.mOpts.theme+"_"+this.mOpts.selectCss),$("#"+b[d]).removeClass(this.mOpts.theme+"_"+this.mOpts.compareCss);$("#"+a).addClass(c),$("#"+a).css("background-repeat","repeat"),this.dateInput=a},pickerDateRange.prototype.formatDate=function(a){return a.replace(/(\d{4})\-(\d{1,2})\-(\d{1,2})/g,function(a,b,c,d){return c<10&&(c="0"+c),d<10&&(d="0"+d),b+"-"+c+"-"+d})},pickerDateRange.prototype.getWeek=function(a,b){switch(a){case 0:return b+"日";case 1:return b+"一";case 2:return b+"二";case 3:return b+"三";case 4:return b+"四";case 5:return b+"五";case 6:return b+"六"}},pickerDateRange.prototype.getLunarDate=function(a,b,c){function d(a,b){return a>>b&1}function e(){arguments[1]<10&&(arguments[1]="0"+arguments[1]),arguments[2]<10&&(arguments[2]="0"+arguments[2]),m=3!=arguments.length?new Date:new Date(arguments[0],arguments[1],arguments[2]);var a,b,c,e,f=!1,g=m.getYear();for(g<1900&&(g+=1900),a=365*(g-1921)+Math.floor((g-1921)/4)+p[m.getMonth()]+m.getDate()-38,m.getYear()%4==0&&m.getMonth()>1&&a++,b=0;;b++){for(e=o[b]<4095?11:12,c=e;c>=0;c--){if(a<=29+d(o[b],c)){f=!0;break}a=a-29-d(o[b],c)}if(f)break}j=1921+b,k=e-c+1,l=a,12==e&&(k==Math.floor(o[b]/65536)+1&&(k=1-k),k>Math.floor(o[b]/65536)+1&&k--)}function f(){g();var a,b,c;a=q.charAt((j-4)%10),a+=r.charAt((j-4)%12),a+="(",a+=u.charAt((j-4)%12),a+=")年",k<1?(b="(闰)",b+=t.charAt(-k-1)):b=t.charAt(k-1),b+="月",c=l<11?"初":l<20?"十":l<30?"廿":"三十",l%10==0&&10!=l||(c+=s.charAt((l-1)%10)),1==l&&(c=b),""!=nfestival&&(c=nfestival);var d={soyear:a,somonth:b,soday:c,nfestival:nfestival,gfestival:gfestival};return d}function g(){nfestival="",gfestival="";for(var a=new h(k,l),b=new h(n,c),d=0;d<w.length;d++)parseInt(w[d].substr(0,2))==a.mm&&parseInt(w[d].substr(2,4))==a.dd&&(nfestival=w[d].substr(5));for(var d=0;d<v.length;d++)parseInt(v[d].substr(0,2))==b.mm&&parseInt(v[d].substr(2,4))==b.dd&&(gfestival=v[d].substr(5))}function h(a,b){a<10&&(a="0"+a),b<10&&(b="0"+b),this.mm=a,this.dd=b}function i(a,b,c){return a=a<1900?1900+a:a,c=c,a<1921||a>2100?"":(n=b,b=parseInt(b)>0?b-1:11,e(a,b,c),f())}var j,k,l,m,c,n,o=new Array(100),p=new Array(12),q="甲乙丙丁戊己庚辛壬癸",r="子丑寅卯辰巳午未申酉戌亥",s="一二三四五六七八九十",t="正二三四五六七八九十冬腊",u="鼠牛虎兔龙蛇马羊猴鸡狗猪",v=(new Array("小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"),new Array("0101 元旦","0214 情人节","0308 妇女节","0312 植树","0401 愚人节","0501 劳动节","0504 青年节","0512 护士节","0601 儿童节","0701 建党","0801 建军","0910 教师节","1001 国庆","1006 老人节","1224 平安夜","1225 圣诞")),w=new Array("0101 春节","0115 元宵节","0505 端午节","0707 七夕","0715 中元节","0815 中秋节","0909 重阳节","1208 腊八节","1224 小年");return o=new Array(2635,333387,1701,1748,267701,694,2391,133423,1175,396438,3402,3749,331177,1453,694,201326,2350,465197,3221,3402,400202,2901,1386,267611,605,2349,137515,2709,464533,1738,2901,330421,1242,2651,199255,1323,529706,3733,1706,398762,2741,1206,267438,2647,1318,204070,3477,461653,1386,2413,330077,1197,2637,268877,3365,531109,2900,2922,398042,2395,1179,267415,2635,661067,1701,1748,398772,2742,2391,330031,1175,1611,200010,3749,527717,1452,2742,332397,2350,3222,268949,3402,3493,133973,1386,464219,605,2349,334123,2709,2890,267946,2773,592565,1210,2651,395863,1323,2707,265877),p[0]=0,p[1]=31,p[2]=59,p[3]=90,p[4]=120,p[5]=151,p[6]=181,p[7]=212,p[8]=243,p[9]=273,p[10]=304,p[11]=334,i(a,b,c)};